<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Preview Not Found</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root {
        color-scheme: light dark;
      }
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        margin: 0;
        padding: 2rem;
        display: flex;
        min-height: 100vh;
        align-items: center;
        justify-content: center;
        background: #0b1021;
        color: #f8fafc;
      }
      .panel {
        max-width: 40rem;
        background: rgba(15, 23, 42, 0.75);
        border-radius: 1rem;
        padding: 2.5rem;
        backdrop-filter: blur(12px);
        box-shadow: 0 25px 50px -12px rgba(15, 23, 42, 0.45);
      }
      h1 {
        font-size: clamp(1.8rem, 1.2rem + 2vw, 2.4rem);
        margin-bottom: 1rem;
      }
      p {
        line-height: 1.6;
        margin: 0.75rem 0;
      }
      code {
        background: rgba(148, 163, 184, 0.18);
        padding: 0.25rem 0.5rem;
        border-radius: 0.45rem;
        font-size: 0.9rem;
      }
      a {
        color: #38bdf8;
        text-decoration: none;
      }
      a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <main class="panel">
      <h1>We couldn&rsquo;t load that preview.</h1>
      <p>
        The request was routed through CloudFront but the underlying preview
        assets were not found. This can happen if the PR environment has not
        finished deploying, the preview path is incorrect, or the preview has been
        cleaned up.
      </p>
      <p>
        If this preview should exist, refresh in a few minutes. Previews may
        take up to 5&ndash;10 minutes to propagate after deployment or after
        invalidation completes.
      </p>
      <p>
        Need help? Share the failing URL with the release engineering team so we
        can check CloudFront logs and deployment status.
      </p>
      <p><code id="requested-url"></code></p>
      <p><a id="back-link" href="/">Back to production site</a></p>
    </main>
    <script>
      (function () {
        var ref = document.referrer || window.location.href;
        var urlEl = document.getElementById("requested-url");
        if (urlEl) {
          urlEl.textContent = ref;
        }
        var backLink = document.getElementById("back-link");
        if (backLink && ref) {
          try {
            var parsed = new URL(ref);
            // For path-based previews on deploy.beakerstack.com, go to production
            if (parsed.hostname === "deploy.beakerstack.com" || parsed.hostname.startsWith("deploy.")) {
              // Extract base domain (beakerstack.com)
              var domainParts = parsed.hostname.split(".");
              if (domainParts.length > 2) {
                domainParts.shift(); // Remove "deploy"
                parsed.hostname = domainParts.join(".");
              }
              parsed.pathname = "/";
              backLink.href = parsed.toString();
            } else {
              // For other domains, just go to root
              parsed.pathname = "/";
              backLink.href = parsed.toString();
            }
          } catch (err) {
            // noop
          }
        }
      })();
    </script>
  </body>
</html>

